# 架构设计

## 整体架构

FDX SMART WORK 2.0 采用现代化的前端架构设计，基于 Next.js App Router 构建。

```
┌─────────────────────────────────────────┐
│                 用户界面                │
├─────────────────────────────────────────┤
│              页面组件层                 │
├─────────────────────────────────────────┤
│              业务组件层                 │
├─────────────────────────────────────────┤
│              基础组件层                 │
├─────────────────────────────────────────┤
│              工具函数层                 │
├─────────────────────────────────────────┤
│              数据管理层                 │
└─────────────────────────────────────────┘
```

## 目录结构设计

### App Router 结构
```
src/app/
├── (auth)/          # 认证相关页面组
├── (dashboard)/     # 仪表板页面组
├── (workshop)/      # 工作坊页面组
├── globals.css      # 全局样式
├── layout.tsx       # 根布局
└── page.tsx         # 首页
```

### 组件架构
```
src/components/
├── ui/              # 基础UI组件 (shadcn/ui)
├── layout/          # 布局组件
├── forms/           # 表单组件
├── charts/          # 图表组件
└── common/          # 通用组件
```

## 组件设计原则

### 1. 组件优先级
1. **现有组件**: 优先使用项目中已有的组件
2. **Shadcn/UI组件**: 使用标准UI组件库
3. **自定义组件**: 最后选择创建自定义组件

### 2. 组件分层
- **页面组件**: 路由级别的组件
- **业务组件**: 特定业务逻辑的组件
- **基础组件**: 可复用的UI组件

### 3. 状态管理
- **本地状态**: useState, useReducer
- **全局状态**: React Context
- **服务器状态**: SWR

## 数据流设计

### 数据流向
```
用户操作 → 组件事件 → 状态更新 → UI重新渲染
```

### API调用流程
```
组件 → API函数 → Fetch请求 → Supabase → 数据返回
```

## 路由设计

### 页面路由结构
```
/                    # 首页
/profile             # 数字工牌
/tasks               # 任务通知
/situation           # 情况上报
/attendance          # 考勤打卡
/points              # 积分系统
/lab                 # 实验室数据
/ball-mill           # 球磨工作坊
/filter-press        # 压滤工作坊
/boss                # 老板管理页面
/manager             # 经理管理页面
```

### 路由组织
- 使用 App Router 的文件系统路由
- 支持嵌套路由和布局
- 实现路由级别的代码分割

## 性能优化策略

### 1. 代码分割
- 路由级别的懒加载
- 组件级别的动态导入
- 第三方库的按需加载

### 2. 缓存策略
- 静态资源缓存
- API响应缓存
- 组件级别的缓存

### 3. 渲染优化
- Server Components 优先
- 客户端组件最小化
- 图片优化和懒加载

## 安全设计

### 1. 认证授权
- JWT Token 管理
- 角色权限控制
- 路由保护

### 2. 数据安全
- 输入验证
- XSS防护
- CSRF保护

## 可扩展性设计

### 1. 模块化设计
- 功能模块独立
- 组件可复用
- 配置可扩展

### 2. 插件化架构
- 支持功能插件
- 主题插件系统
- 第三方集成
